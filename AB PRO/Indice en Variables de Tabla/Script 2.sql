

USE [1G_KANZ]
GO

DECLARE @tFacturasBulk AS TABLE(
    [id_fac_det] INT,
    [id_fac] INT,
    [id_doc_vta] INT,
    [sub] FLOAT(8),
    [imptos] FLOAT(8),
    [total] FLOAT(8),
    [id_suc] INT,
    [no_part] INT,
    [id_pro] INT,
    [udm] VARCHAR(10),
    [cant] FLOAT(8),
    [precio_orig] FLOAT(8),
    [promoc] FLOAT(8),
    [precio_pub] FLOAT(8),
    [dcto_ptg] FLOAT(8),
    [precio_cimptos] FLOAT(8),
    [importe_cimptos] FLOAT(8),
    [precio_pub_simptos] FLOAT(8),
    [precio_simptos] FLOAT(8),
    [importe_simptos] FLOAT(8),
    [montos_imptos] FLOAT(8),
    [id_impto] INT,
    [c_cambio_prec] TINYINT,
    [costo] FLOAT(8),
    [monto_descto] FLOAT(8),
    [costo_total] FLOAT(8),
    [id_almac] INT,
    [id_nota] INT,
    [tipo] TINYINT,
    [tipo_pro] TINYINT,
    [es_sub] TINYINT,
    [cant_dev] FLOAT(8),
    [por_facturar] FLOAT(8),
    [id_rem] INT,
    [id_rem_part] INT,
    [id_fac_det_kit] INT,
    [id_mda] INT,
    [tc] FLOAT(8),
    [oper] TINYINT,
    [sub_bse] FLOAT(8),
    [imptos_bse] FLOAT(8),
    [total_bse] FLOAT(8),
    [precio_orig_bse] FLOAT(8),
    [precio_pub_bse] FLOAT(8),
    [precio_cimptos_bse] FLOAT(8),
    [importe_cimptos_bse] FLOAT(8),
    [precio_pub_simptos_bse] FLOAT(8),
    [precio_simptos_bse] FLOAT(8),
    [importe_simptos_bse] FLOAT(8),
    [monto_imptos_bse] FLOAT(8),
    [monto_descto_bse] FLOAT(8),
    [id_com_ser_lot] INT,
    [dias_ent] INT,
    [fec_prom] DATETIME,
    [fec_emb] DATETIME,
    [fec_req] DATETIME,
    [id_prg_ent_fac_det] INT,
    [cant_surt] FLOAT(8),
    [por_solic] FLOAT(8),
    [id_part_pad] INT,
    [id_pro_ord] INT,
    [cant_ord_pro] FLOAT(8),
    [id_pro_lis] INT,
    [id_lis_pre] INT,
    [c_prec_modif] INT,
    [id_kardex] INT,
    [id_cod_srv] INT,
    [id_cen_cto] INT,
    [id_ref] INT,
    [id_udm] INT,
    [ftr] FLOAT(8),
    [id_ped] INT,
    [id_ped_part] INT,
    [num_ped] INT,
    [id_cot] INT,
    [id_cot_part] INT,
    [num_cot] INT,
    [id_spt] INT,
    [id_spt_part] INT,
    [num_spt] INT,
    [id_pad] INT,
    [id_tip_doc_pad] INT,
    [num_pad] INT,
    [num_ped_cli] VARCHAR(50),
    [num_req_cli] VARCHAR(50),
    [id_clas_pro] INT,
    [id_rel_impto] INT,
    [num_rem] INT,
    [id_act] INT,
    [id_clas_act] INT,
    [valor_base] FLOAT(8),
    [dep_acu] FLOAT(8),
    [dep_rem] FLOAT(8),
    [campo1] INT,
    [campo2] INT,
    [campo3] INT,
    [campo4] INT,
    [campo5] VARCHAR(50),
    [campo6] VARCHAR(50),
    [campo7] VARCHAR(50),
    [campo8] VARCHAR(50),
    [campo9] VARCHAR(50),
    [campo10] DATETIME,
    [c_prg] TINYINT,
    [id_pro_paq] INT,
    [id_part_ori] INT,
    [sec] INT,
    [id_int] INT,
    [id_cli_cta_de] INT,
    [id_ref_det] INT,
    [ptg_kit] FLOAT(8),
    [ref_ext] NVARCHAR(64),
    [base_grav] FLOAT(8),
    [tip_hon] INT,
    [ptg_hon] FLOAT(8),
    [mod_impto] TINYINT,
    [precio_ext] FLOAT(8),
    [Campo11] INT,
    [Campo12] INT,
    [Campo13] INT,
    [Campo14] INT,
    [Campo15] INT,
    [Campo16] INT,
    [Campo17] FLOAT(8),
    [Campo18] FLOAT(8),
    [Campo19] FLOAT(8),
    [Campo20] FLOAT(8),
    [Campo21] FLOAT(8),
    [Campo22] FLOAT(8),
    [Campo23] FLOAT(8),
    [Campo24] FLOAT(8),
    [Campo25] FLOAT(8),
    [Campo26] DATETIME,
    [Campo27] DATETIME,
    [Campo28] DATETIME,
    [Campo29] DATETIME,
    [Campo30] VARCHAR(50),
    [Campo31] VARCHAR(50),
    [Campo32] VARCHAR(50),
    [Campo33] VARCHAR(50),
    [Campo34] VARCHAR(50),
    [Campo35] VARCHAR(50),
    [Campo36] VARCHAR(50),
    [Campo37] VARCHAR(50),
    [Campo38] VARCHAR(50),
    [Campo39] VARCHAR(50),
    [Campo40] VARCHAR(50),
    [id_Nota2] INT,
    [id_Nota3] INT,
    [tip_com] TINYINT,
    [ptg_com] FLOAT(8),
    [mto_com] FLOAT(8),
    [id_sis_lis_pre] INT,
    [id_tar_hon] INT,
    [des_tar_hon] VARCHAR(50),
    [id_fis_rel] INT,
    [id_ope_ext] INT,
    [id_part_alm_sir] INT,
    [dias_alm_sir] FLOAT(8),
    [dias_lib_alm_sir] FLOAT(8),
    [dias_dcto_alm_sir] FLOAT(8),
    [fec_corte_alm_sir] DATETIME,
    [id_almje_gral] INT,
    [id_almje_esp] INT,
    [cmt] VARCHAR(50),
    [des_hon] VARCHAR(50),
    [des] VARCHAR(254),
    [c_afe_exis_vta] INT,
    [id_com] INT,
    [num_grp] INT,
    [cant_surt_aut] FLOAT(8),
    [apartado] FLOAT(8),
    [backorder] FLOAT(8),
    [fec_ped_cli] DATETIME,
    [aum_ptg] FLOAT(8),
    [cant_trasp] FLOAT(8),
    [partcerrpedcot] TINYINT,
    [id_tur_req] INT,
    [id_tur_prom] INT,
    [id_mov_part] INT,
    [no_part_pad] INT,
    [c_ptg_ing] TINYINT,
    [ptg_ing] FLOAT(8),
    [id_prov_ter] INT,
    [id_rel_gas] INT,
    [c_prov_gas_cor] TINYINT,
    [dcto_cupon] FLOAT(8),
    [dcto_voucher] FLOAT(8),
    [dcto_cupon_bse] FLOAT(8),
    [dcto_voucher_bse] FLOAT(8),
    [mto_confirmado] FLOAT(8),
    [mto_futuro] FLOAT(8),
    [mto_otros] FLOAT(8),
    [mto_confirmado_bse] FLOAT(8),
    [mto_futuro_bse] FLOAT(8),
    [mto_otros_bse] FLOAT(8),
    [id_motv_cnl] INT

);

DECLARE @tFacturas AS TABLE(
    [id_fac_det] INT,
    [id_fac] INT,
    [id_doc_vta] INT,
    [sub] FLOAT(8),
    [imptos] FLOAT(8),
    [total] FLOAT(8),
    [id_suc] INT,
    [no_part] INT,
    [id_pro] INT,
    [udm] VARCHAR(10),
    [cant] FLOAT(8),
    [precio_orig] FLOAT(8),
    [promoc] FLOAT(8),
    [precio_pub] FLOAT(8),
    [dcto_ptg] FLOAT(8),
    [precio_cimptos] FLOAT(8),
    [importe_cimptos] FLOAT(8),
    [precio_pub_simptos] FLOAT(8),
    [precio_simptos] FLOAT(8),
    [importe_simptos] FLOAT(8),
    [montos_imptos] FLOAT(8),
    [id_impto] INT,
    [c_cambio_prec] TINYINT,
    [costo] FLOAT(8),
    [monto_descto] FLOAT(8),
    [costo_total] FLOAT(8),
    [id_almac] INT,
    [id_nota] INT,
    [tipo] TINYINT,
    [tipo_pro] TINYINT,
    [es_sub] TINYINT,
    [cant_dev] FLOAT(8),
    [por_facturar] FLOAT(8),
    [id_rem] INT,
    [id_rem_part] INT,
    [id_fac_det_kit] INT,
    [id_mda] INT,
    [tc] FLOAT(8),
    [oper] TINYINT,
    [sub_bse] FLOAT(8),
    [imptos_bse] FLOAT(8),
    [total_bse] FLOAT(8),
    [precio_orig_bse] FLOAT(8),
    [precio_pub_bse] FLOAT(8),
    [precio_cimptos_bse] FLOAT(8),
    [importe_cimptos_bse] FLOAT(8),
    [precio_pub_simptos_bse] FLOAT(8),
    [precio_simptos_bse] FLOAT(8),
    [importe_simptos_bse] FLOAT(8),
    [monto_imptos_bse] FLOAT(8),
    [monto_descto_bse] FLOAT(8),
    [id_com_ser_lot] INT,
    [dias_ent] INT,
    [fec_prom] DATETIME,
    [fec_emb] DATETIME,
    [fec_req] DATETIME,
    [id_prg_ent_fac_det] INT,
    [cant_surt] FLOAT(8),
    [por_solic] FLOAT(8),
    [id_part_pad] INT,
    [id_pro_ord] INT,
    [cant_ord_pro] FLOAT(8),
    [id_pro_lis] INT,
    [id_lis_pre] INT,
    [c_prec_modif] INT,
    [id_kardex] INT,
    [id_cod_srv] INT,
    [id_cen_cto] INT,
    [id_ref] INT,
    [id_udm] INT,
    [ftr] FLOAT(8),
    [id_ped] INT,
    [id_ped_part] INT,
    [num_ped] INT,
    [id_cot] INT,
    [id_cot_part] INT,
    [num_cot] INT,
    [id_spt] INT,
    [id_spt_part] INT,
    [num_spt] INT,
    [id_pad] INT,
    [id_tip_doc_pad] INT,
    [num_pad] INT,
    [num_ped_cli] VARCHAR(50),
    [num_req_cli] VARCHAR(50),
    [id_clas_pro] INT,
    [id_rel_impto] INT,
    [num_rem] INT,
    [id_act] INT,
    [id_clas_act] INT,
    [valor_base] FLOAT(8),
    [dep_acu] FLOAT(8),
    [dep_rem] FLOAT(8),
    [campo1] INT,
    [campo2] INT,
    [campo3] INT,
    [campo4] INT,
    [campo5] VARCHAR(50),
    [campo6] VARCHAR(50),
    [campo7] VARCHAR(50),
    [campo8] VARCHAR(50),
    [campo9] VARCHAR(50),
    [campo10] DATETIME,
    [c_prg] TINYINT,
    [id_pro_paq] INT,
    [id_part_ori] INT,
    [sec] INT,
    [id_int] INT,
    [id_cli_cta_de] INT,
    [id_ref_det] INT,
    [ptg_kit] FLOAT(8),
    [ref_ext] NVARCHAR(64),
    [base_grav] FLOAT(8),
    [tip_hon] INT,
    [ptg_hon] FLOAT(8),
    [mod_impto] TINYINT,
    [precio_ext] FLOAT(8),
    [Campo11] INT,
    [Campo12] INT,
    [Campo13] INT,
    [Campo14] INT,
    [Campo15] INT,
    [Campo16] INT,
    [Campo17] FLOAT(8),
    [Campo18] FLOAT(8),
    [Campo19] FLOAT(8),
    [Campo20] FLOAT(8),
    [Campo21] FLOAT(8),
    [Campo22] FLOAT(8),
    [Campo23] FLOAT(8),
    [Campo24] FLOAT(8),
    [Campo25] FLOAT(8),
    [Campo26] DATETIME,
    [Campo27] DATETIME,
    [Campo28] DATETIME,
    [Campo29] DATETIME,
    [Campo30] VARCHAR(50),
    [Campo31] VARCHAR(50),
    [Campo32] VARCHAR(50),
    [Campo33] VARCHAR(50),
    [Campo34] VARCHAR(50),
    [Campo35] VARCHAR(50),
    [Campo36] VARCHAR(50),
    [Campo37] VARCHAR(50),
    [Campo38] VARCHAR(50),
    [Campo39] VARCHAR(50),
    [Campo40] VARCHAR(50),
    [id_Nota2] INT,
    [id_Nota3] INT,
    [tip_com] TINYINT,
    [ptg_com] FLOAT(8),
    [mto_com] FLOAT(8),
    [id_sis_lis_pre] INT,
    [id_tar_hon] INT,
    [des_tar_hon] VARCHAR(50),
    [id_fis_rel] INT,
    [id_ope_ext] INT,
    [id_part_alm_sir] INT,
    [dias_alm_sir] FLOAT(8),
    [dias_lib_alm_sir] FLOAT(8),
    [dias_dcto_alm_sir] FLOAT(8),
    [fec_corte_alm_sir] DATETIME,
    [id_almje_gral] INT,
    [id_almje_esp] INT,
    [cmt] VARCHAR(50),
    [des_hon] VARCHAR(50),
    [des] VARCHAR(254),
    [c_afe_exis_vta] INT,
    [id_com] INT,
    [num_grp] INT,
    [cant_surt_aut] FLOAT(8),
    [apartado] FLOAT(8),
    [backorder] FLOAT(8),
    [fec_ped_cli] DATETIME,
    [aum_ptg] FLOAT(8),
    [cant_trasp] FLOAT(8),
    [partcerrpedcot] TINYINT,
    [id_tur_req] INT,
    [id_tur_prom] INT,
    [id_mov_part] INT,
    [no_part_pad] INT,
    [c_ptg_ing] TINYINT,
    [ptg_ing] FLOAT(8),
    [id_prov_ter] INT,
    [id_rel_gas] INT,
    [c_prov_gas_cor] TINYINT,
    [dcto_cupon] FLOAT(8),
    [dcto_voucher] FLOAT(8),
    [dcto_cupon_bse] FLOAT(8),
    [dcto_voucher_bse] FLOAT(8),
    [mto_confirmado] FLOAT(8),
    [mto_futuro] FLOAT(8),
    [mto_otros] FLOAT(8),
    [mto_confirmado_bse] FLOAT(8),
    [mto_futuro_bse] FLOAT(8),
    [mto_otros_bse] FLOAT(8),
    [id_motv_cnl] INT,

	INDEX IX1(fec_prom)
);

INSERT INTO @tFacturasBulk
SELECT * 
FROM dbo.vta_fac_det  WITH(NOLOCK) 

INSERT INTO @tFacturas
SELECT * 
FROM @tFacturasBulk 

--DELETE FROM @tFacturasBulk

SELECT * FROM @tFacturas b WHERE b.fec_prom BETWEEN '20210101' AND '20240101'


